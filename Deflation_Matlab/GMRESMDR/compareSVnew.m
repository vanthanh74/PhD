clear all
close all
clc
%sherman3

mat = [ 4.9693e-02   4.9693e-02   1.8922e-01   8.4786e-02   3.2196e-01   3.2131e-01
   4.9060e-02   4.9060e-02   1.7032e-01   8.2346e-02   3.1959e-01   3.1936e-01
   4.8995e-02   4.8995e-02   1.6534e-01   8.1399e-02   3.1497e-01   3.1436e-01
   4.8894e-02   4.8894e-02   1.6431e-01   8.1230e-02   3.1164e-01   3.1133e-01
   4.8103e-02   4.8103e-02   1.5913e-01   8.0486e-02   3.0751e-01   3.0658e-01
   4.6313e-02   4.6313e-02   1.5201e-01   7.9057e-02   3.0062e-01   3.0000e-01
   4.5181e-02   4.5181e-02   1.4930e-01   7.7185e-02   2.9853e-01   2.9800e-01
   4.4928e-02   4.4928e-02   1.4688e-01   7.6961e-02   2.9312e-01   2.9289e-01
   4.4901e-02   4.4901e-02   1.4574e-01   7.5354e-02   2.8590e-01   2.8531e-01
   4.4817e-02   4.4817e-02   1.4441e-01   7.4990e-02   2.8486e-01   2.8405e-01
   4.4070e-02   4.4070e-02   1.3434e-01   7.3793e-02   2.8070e-01   2.8026e-01
   4.3429e-02   4.3429e-02   1.3228e-01   7.1368e-02   2.7994e-01   2.7856e-01
   4.1863e-02   4.1863e-02   1.2531e-01   6.9944e-02   2.7401e-01   2.7335e-01
   4.1009e-02   4.1009e-02   1.1648e-01   6.9134e-02   2.6973e-01   2.6443e-01
   4.0350e-02   4.0350e-02   1.1439e-01   6.7171e-02   2.6106e-01   2.6015e-01
   3.7720e-02   3.7720e-02   1.1332e-01   6.6654e-02   2.5895e-01   2.5696e-01
   3.6348e-02   3.6348e-02   1.1315e-01   6.4669e-02   2.5416e-01   2.5177e-01
   3.2491e-02   3.2491e-02   1.1258e-01   6.4459e-02   2.4829e-01   2.4733e-01
   3.1387e-02   3.1387e-02   1.1219e-01   6.4418e-02   2.4130e-01   2.4000e-01
   3.1111e-02   3.1111e-02   1.0594e-01   6.3051e-02   2.3800e-01   2.3674e-01
   2.8638e-02   2.8638e-02   1.0548e-01   6.1704e-02   2.3716e-01   2.3430e-01
   2.8417e-02   2.8417e-02   1.0515e-01   5.9704e-02   2.2599e-01   2.2321e-01
   2.7966e-02   2.7966e-02   1.0405e-01   5.8535e-02   2.2289e-01   2.1983e-01
   2.6609e-02   2.6609e-02   1.0377e-01   5.4917e-02   2.1810e-01   2.1262e-01
   2.4455e-02   2.4455e-02   1.0230e-01   5.3242e-02   2.1507e-01   2.0742e-01
   2.1360e-02   2.1360e-02   9.6972e-02   5.2746e-02   2.1028e-01   2.0442e-01
   1.8290e-02   1.8290e-02   9.2597e-02   5.2237e-02   2.0520e-01   1.9443e-01
   1.7500e-02   1.7500e-02   8.3201e-02   5.2167e-02   1.9744e-01   1.9265e-01
   1.6174e-02   1.6174e-02   7.7048e-02   5.1563e-02   1.9345e-01   1.8114e-01
   1.4394e-02   1.4394e-02   7.0224e-02   5.0962e-02   1.8244e-01   1.7099e-01
   1.2472e-02   1.2472e-02   6.1011e-02   4.9986e-02   1.7734e-01   1.6139e-01
   1.1612e-02   1.1612e-02   6.0245e-02   4.9506e-02   1.7254e-01   1.5051e-01
   1.0976e-02   1.0976e-02   5.0804e-02   4.8562e-02   1.6142e-01   1.4686e-01
   9.3993e-03   9.3993e-03   3.9018e-02   4.7457e-02   1.5300e-01   1.4151e-01
   7.1714e-03   7.1714e-03   3.7322e-02   4.3935e-02   1.4703e-01   1.3396e-01
   6.2581e-03   6.2581e-03   2.9157e-02   4.2589e-02   1.3971e-01   1.2496e-01
   6.1102e-03   6.1102e-03   2.5883e-02   4.1069e-02   1.3573e-01   1.2124e-01
   4.7889e-03   4.7889e-03   1.8625e-02   3.8095e-02   1.3398e-01   1.1273e-01
   4.7615e-03   4.7615e-03   1.8017e-02   3.5217e-02   1.2478e-01   1.0070e-01
   4.2960e-03   4.2960e-03   1.2313e-02   3.5113e-02   1.1355e-01   9.4609e-02
   3.1006e-03   3.1006e-03   1.2110e-02   3.3120e-02   9.6731e-02   9.1324e-02
   1.8085e-03   1.8085e-03   1.1312e-02   3.0893e-02   8.5896e-02   7.5434e-02
   1.4388e-03   1.4388e-03   8.1391e-03   2.9756e-02   7.4095e-02   6.0220e-02
   1.3501e-03   1.3501e-03   5.1088e-03   2.6763e-02   6.3929e-02   5.5634e-02
   9.2177e-04   9.2177e-04   3.7932e-03   2.6546e-02   5.6480e-02   5.1814e-02
   1.9145e-04   1.9145e-04   5.9117e-04   2.3408e-02   4.2318e-02   3.3730e-02
   1.2683e-04   1.2683e-04   3.5262e-04   2.1666e-02   3.3232e-02   3.0346e-02
   1.1206e-04   1.1206e-04   2.8934e-04   1.8858e-02   1.2653e-02   1.0710e-02
   4.8374e-05   4.8374e-05   1.3127e-04   1.5526e-02   1.1592e-02   1.0345e-02
   3.8946e-05   3.8946e-05   1.2488e-04   1.2339e-02   3.4498e-03   2.9702e-03]


sv_A = mat(:,1);
sv_R22 = mat(:,3);
sv_MinvA = mat(:,4);

figure
semilogy(sv_A,'.-r')
hold on
semilogy(sv_R22,'.-b')
semilogy(sv_MinvA,'.-k')
h=legend('A','$R_{22}$','$\tilde{M}^{-1}A$')
set(h,'interpreter','Latex','FontSize',13);
xlabel('Singular value index')
ylabel('Absolute magnitude')
title('Smallest singular values')

