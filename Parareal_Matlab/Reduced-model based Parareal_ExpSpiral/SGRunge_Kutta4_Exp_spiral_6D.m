function u=SGRunge_Kutta4_Exp_spiral_6D(f,t0,t1,u0,n)
global c
[t,u]=Runge_Kutta4_Exp_spiral(f,[t0 t1],u0,n);
u=u(end,:);
u_old = u;

u(4) = u_old(1)*(u_old(1)*u_old(4) + u_old(2)*u_old(5))*cos(c*(t1-t0))/(u_old(1)^2+u_old(2)^2) ...
    - u_old(1)*u_old(6)/(sqrt(u_old(1)^2+u_old(2)^2))*sin(c*(t1-t0)) ...
    + u_old(2)*(u_old(4)*u_old(2) - u_old(5)*u_old(1))/(u_old(1)^2+u_old(2)^2) ;
u(5) = u_old(2)*(u_old(1)*u_old(4) + u_old(2)*u_old(5))*cos(c*(t1-t0))/(u_old(1)^2+u_old(2)^2) ...
    - u_old(2)*u_old(6)/(sqrt(u_old(1)^2+u_old(2)^2))*sin(c*(t1-t0)) ...
    - u_old(1)*(u_old(2)*u_old(4) - u_old(1)*u_old(5))/(u_old(1)^2+u_old(2)^2) ;
u(6) = (u_old(1)*u_old(4) + u_old(2)*u_old(5))*sin(c*(t1-t0))/sqrt(u_old(1)^2 + u_old(2)^2) ...
    +  u_old(6)*cos(c*(t1-t0));

